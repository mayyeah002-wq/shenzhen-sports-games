<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>绿色场馆能源连连看</title>
    <!-- 引入Font Awesome图标库（必须保留，否则图标无法显示） -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* 全局样式重置与基础设置 */
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
          font-family: "Microsoft YaHei", Arial, sans-serif;
        }

        body {
          background-color: #f0f8f5;
          padding: 20px;
        }

        /* 游戏容器 */
        .game-container {
          max-width: 900px;
          margin: 0 auto;
          background-color: #ffffff;
          border-radius: 12px;
          box-shadow: 0 4px 16px rgba(0, 100, 0, 0.1);
          padding: 25px;
          overflow: hidden;
        }

        /* 游戏头部 */
        .game-header {
          text-align: center;
          margin-bottom: 25px;
          color: #2d6a4f;
        }

        .game-header h3 {
          font-size: 24px;
          margin-bottom: 10px;
        }

        .game-header p {
          color: #52b788;
          margin-bottom: 15px;
          font-size: 14px;
        }

        .game-stats {
          font-size: 15px;
          font-weight: 500;
          background-color: #f8fff9;
          display: inline-block;
          padding: 8px 16px;
          border-radius: 20px;
          border: 1px solid #d8f3dc;
        }

        /* 游戏棋盘（卡片容器） */
        .game-board {
          display: grid;
          grid-template-columns: repeat(4, 1fr);
          gap: 15px;
          margin: 0 auto 30px;
          max-width: 700px;
        }

        /* 游戏卡片样式 */
        .game-card {
          height: 120px;
          border-radius: 8px;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 10px;
          text-align: center;
          font-size: 14px;
          font-weight: 500;
          cursor: pointer;
          transition: all 0.3s ease;
          background-color: #f8fff9;
          border: 2px solid #d8f3dc;
          color: #2d6a4f;
          transform: rotateY(0deg);
          backface-visibility: hidden;
        }

        /* 卡片翻转状态 */
        .game-card.flipped {
          background-color: #2d6a4f;
          color: #ffffff;
          border-color: #52b788;
          transform: rotateY(180deg);
        }

        /* 卡片配对成功状态 */
        .game-card.matched {
          background-color: #52b788;
          color: #ffffff;
          border-color: #2d6a4f;
          cursor: not-allowed;
          opacity: 0.9;
        }

        /* 游戏控制按钮 */
        .game-controls {
          text-align: center;
          margin-bottom: 20px;
          display: flex;
          gap: 15px;
          justify-content: center;
          flex-wrap: wrap;
        }

        .game-btn {
          padding: 10px 25px;
          border-radius: 25px;
          border: none;
          background-color: #2d6a4f;
          color: #ffffff;
          font-size: 15px;
          cursor: pointer;
          transition: all 0.3s ease;
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .game-btn:disabled {
          background-color: #d8f3dc;
          color: #95d5b2;
          cursor: not-allowed;
        }

        .game-btn:hover:not(:disabled) {
          background-color: #1b4332;
          transform: translateY(-2px);
        }

        /* 知识点弹窗样式 */
        .knowledge-popup {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background-color: rgba(0, 0, 0, 0.5);
          display: none;
          align-items: center;
          justify-content: center;
          z-index: 100;
        }

        .popup-content {
          background-color: #ffffff;
          border-radius: 12px;
          padding: 30px;
          max-width: 500px;
          width: 90%;
          color: #2d6a4f;
        }

        .popup-content h4 {
          font-size: 20px;
          margin-bottom: 15px;
          padding-bottom: 10px;
          border-bottom: 1px solid #d8f3dc;
        }

        .popup-content p {
          margin-bottom: 20px;
          line-height: 1.6;
        }

        .popup-example h5 {
          font-size: 16px;
          margin-bottom: 10px;
          color: #52b788;
        }

        #closePopup {
          padding: 8px 20px;
          border-radius: 20px;
          border: none;
          background-color: #2d6a4f;
          color: #ffffff;
          font-size: 14px;
          cursor: pointer;
          transition: all 0.3s ease;
          display: block;
          margin: 0 auto;
        }

        #closePopup:hover {
          background-color: #1b4332;
        }

        /* 响应式适配 */
        @media (max-width: 768px) {
          .game-board {
            grid-template-columns: repeat(2, 1fr);
          }
          
          .game-card {
            height: 100px;
          }
        }
    </style>
</head>
<body>
    <!-- 游戏容器 -->
    <div class="game-container" id="energyGame">
        <div class="game-header">
            <h3><i class="fas fa-leaf"></i> 绿色场馆能源连连看</h3>
            <p>配对正确的绿色技术与它们的实际效益，了解深圳场馆的可持续智慧</p>
            <div class="game-stats">
                时间: <span id="time">60</span>s | 
                得分: <span id="score">0</span> | 
                剩余配对: <span id="pairsLeft">6</span>
            </div>
        </div>
        
        <div class="game-board" id="gameBoard">
            <!-- 卡片将通过JavaScript动态生成 -->
            <!-- 每张卡包含：data-type="tech"或"benefit" data-id="对应编号" -->
        </div>
        
        <div class="game-controls">
            <button id="startGame" class="game-btn">
                <i class="fas fa-play"></i> 开始游戏
            </button>
            <button id="hint" class="game-btn" disabled>
                <i class="fas fa-lightbulb"></i> 提示
            </button>
            <button id="reset" class="game-btn">
                <i class="fas fa-redo"></i> 重新开始
            </button>
        </div>
        
        <!-- 知识点弹窗 -->
        <div class="knowledge-popup" id="knowledgePopup">
            <div class="popup-content">
                <h4 id="popupTitle"></h4>
                <p id="popupDesc"></p>
                <div class="popup-example">
                    <h5><i class="fas fa-map-marker-alt"></i> 深圳案例</h5>
                    <p id="popupExample"></p>
                </div>
                <button id="closePopup">继续游戏</button>
            </div>
        </div>
    </div>

    <script>
        // 游戏核心数据：绿色技术与对应效益（6组配对）
        const gameData = [
          {
            id: 1,
            tech: "太阳能光伏发电",
            benefit: "利用场馆屋顶/立面收集太阳能，转化为电能供场馆使用，减少市电消耗",
            title: "太阳能光伏发电",
            desc: "一种清洁、可再生的能源利用方式，通过光伏组件将太阳光能直接转化为电能。",
            example: "深圳湾体育中心在屋顶安装了大面积光伏板，年发电量可满足场馆10%以上的日常用电需求，每年减少碳排放超千吨。"
          },
          {
            id: 2,
            tech: "雨水回收利用系统",
            benefit: "收集屋面、广场雨水，经净化后用于绿化灌溉、卫生间冲水，节约水资源",
            title: "雨水回收利用系统",
            desc: "通过收集、储存、净化等环节，将雨水转化为可重复利用的非饮用水资源，降低对市政供水的依赖。",
            example: "深圳大运中心搭建了完善的雨水回收系统，每年可回收利用雨水超5万立方米，有效节约了场馆绿化和保洁用水成本。"
          },
          {
            id: 3,
            tech: "地源热泵空调系统",
            benefit: "利用地下浅层地热资源，实现冬季供暖、夏季制冷，比传统空调节能30%-50%",
            title: "地源热泵空调系统",
            desc: "以地下土壤、地下水等为热源/冷源，通过热泵机组实现能量转移，具有高效、环保、运行稳定的特点。",
            example: "深圳宝安体育中心采用地源热泵系统，夏季制冷能耗比传统空调降低40%，冬季供暖能耗降低35%，年节约电费超百万元。"
          },
          {
            id: 4,
            tech: "绿色屋顶/垂直绿化",
            benefit: "降低场馆室内温度，减少空调负荷，同时吸附粉尘、净化空气，提升生态景观",
            title: "绿色屋顶/垂直绿化",
            desc: "在建筑屋顶或立面种植植物，形成微型生态系统，兼具生态效益与建筑节能效果。",
            example: "深圳市民中心南广场建筑采用垂直绿化设计，墙面绿植覆盖面积超2000平方米，夏季可使建筑外墙温度降低5-8℃。"
          },
          {
            id: 5,
            tech: "智能照明控制系统",
            benefit: "根据场馆人流量、自然光强度自动调节灯光亮度，避免无效照明，节约电能",
            title: "智能照明控制系统",
            desc: "结合传感器、物联网技术，实现照明设备的智能化管控，最大化提升照明效率、降低能耗。",
            example: "深圳龙岗大运中心体育馆配备智能照明系统，比赛日可根据观众席上座率分区调节灯光，非比赛日自动降低亮度，年节约照明用电30%以上。"
          },
          {
            id: 6,
            tech: "余热回收利用设备",
            benefit: "回收场馆空调、通风系统产生的余热，用于热水供应或场馆供暖，提高能源利用率",
            title: "余热回收利用设备",
            desc: "通过专用设备捕获生产生活中产生的废热，将其转化为可用能源，实现能源的梯级利用，减少能源浪费。",
            example: "深圳南山文体中心采用余热回收技术，回收空调系统余热用于场馆淋浴热水供应，每年可节约天然气消耗超2万立方米。"
          }
        ];

        // 游戏全局变量
        let gameStarted = false;
        let timeLeft = 60;
        let score = 0;
        let pairsLeft = 6;
        let timer = null;
        let flippedCards = [];
        let canFlip = true; // 控制是否允许翻转卡片（防止快速连续翻转）

        // DOM元素获取
        const gameBoard = document.getElementById("gameBoard");
        const startBtn = document.getElementById("startGame");
        const hintBtn = document.getElementById("hint");
        const resetBtn = document.getElementById("reset");
        const timeDisplay = document.getElementById("time");
        const scoreDisplay = document.getElementById("score");
        const pairsLeftDisplay = document.getElementById("pairsLeft");
        const knowledgePopup = document.getElementById("knowledgePopup");
        const popupTitle = document.getElementById("popupTitle");
        const popupDesc = document.getElementById("popupDesc");
        const popupExample = document.getElementById("popupExample");
        const closePopupBtn = document.getElementById("closePopup");

        // 初始化游戏：生成打乱顺序的卡片
        function initGame() {
          // 清空棋盘
          gameBoard.innerHTML = "";
          // 构建卡片数组（技术卡 + 效益卡）
          let cardArray = [];
          gameData.forEach(item => {
            // 技术卡
            cardArray.push({
              type: "tech",
              id: item.id,
              content: item.tech,
              data: item
            });
            // 效益卡
            cardArray.push({
              type: "benefit",
              id: item.id,
              content: item.benefit,
              data: item
            });
          });
          // 打乱卡片顺序（Fisher-Yates 洗牌算法）
          cardArray = shuffleArray(cardArray);
          // 生成卡片DOM并添加到棋盘
          cardArray.forEach(card => {
            const cardElement = document.createElement("div");
            cardElement.className = "game-card";
            cardElement.dataset.type = card.type;
            cardElement.dataset.id = card.id;
            cardElement.innerHTML = card.content;
            // 绑定卡片点击事件
            cardElement.addEventListener("click", () => flipCard(cardElement, card.data));
            gameBoard.appendChild(cardElement);
          });
        }

        // 洗牌算法：打乱数组顺序
        function shuffleArray(array) {
          const newArray = [...array];
          for (let i = newArray.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
          }
          return newArray;
        }

        // 卡片翻转逻辑
        function flipCard(cardElement, cardData) {
          // 不满足翻转条件的情况：游戏未开始、卡片已翻转/已配对、不可翻转、同一卡片
          if (!gameStarted || cardElement.classList.contains("flipped") || cardElement.classList.contains("matched") || !canFlip || flippedCards.some(item => item.element === cardElement)) {
            return;
          }

          // 翻转卡片并添加到已翻转数组
          cardElement.classList.add("flipped");
          flippedCards.push({ element: cardElement, id: cardElement.dataset.id, data: cardData });

          // 当翻转了2张卡片时，判断是否配对
          if (flippedCards.length === 2) {
            canFlip = false; // 禁止临时翻转
            const card1 = flippedCards[0];
            const card2 = flippedCards[1];

            if (card1.id === card2.id) {
              // 配对成功
              handleMatch(card1, card2);
            } else {
              // 配对失败
              handleMismatch(card1, card2);
            }
          }
        }

        // 处理卡片配对成功
        function handleMatch(card1, card2) {
          // 更新卡片状态为已配对
          card1.element.classList.add("matched");
          card2.element.classList.remove("flipped"); // 移除翻转样式，保留配对样式
          card2.element.classList.add("matched");
          
          // 更新游戏数据
          score += 10; // 每配对成功一组加10分
          pairsLeft -= 1;
          scoreDisplay.textContent = score;
          pairsLeftDisplay.textContent = pairsLeft;

          // 显示知识点弹窗
          showKnowledgePopup(card1.data);

          // 重置已翻转卡片数组，允许继续翻转
          flippedCards = [];
          canFlip = true;

          // 判断游戏是否胜利（所有配对完成）
          if (pairsLeft === 0) {
            clearInterval(timer);
            setTimeout(() => {
              alert(`恭喜你！游戏胜利！\n最终得分：${score}\n剩余时间：${timeLeft}s`);
              resetGame(false); // 重置游戏（不重置时间/得分初始值）
            }, 500);
          }
        }

        // 处理卡片配对失败
        function handleMismatch(card1, card2) {
          // 2秒后翻转回原始状态
          setTimeout(() => {
            card1.element.classList.remove("flipped");
            card2.element.classList.remove("flipped");
            // 重置已翻转卡片数组，允许继续翻转
            flippedCards = [];
            canFlip = true;
          }, 1000);
        }

        // 显示知识点弹窗
        function showKnowledgePopup(data) {
          popupTitle.textContent = data.title;
          popupDesc.textContent = data.desc;
          popupExample.textContent = data.example;
          knowledgePopup.style.display = "flex";
        }

        // 开始游戏
        function startGame() {
          if (gameStarted) return;

          // 更新游戏状态
          gameStarted = true;
          startBtn.disabled = true;
          hintBtn.disabled = false;

          // 启动计时器
          timer = setInterval(() => {
            timeLeft -= 1;
            timeDisplay.textContent = timeLeft;

            // 时间耗尽，游戏结束
            if (timeLeft <= 0) {
              clearInterval(timer);
              gameStarted = false;
              hintBtn.disabled = true;
              alert(`游戏结束！\n最终得分：${score}\n剩余配对：${pairsLeft}组`);
              resetGame(false);
            }
          }, 1000);
        }

        // 游戏提示：高亮一组未配对的卡片
        function giveHint() {
          if (!gameStarted || pairsLeft === 0) return;

          // 查找所有未配对的卡片
          const unmatchedCards = document.querySelectorAll(".game-card:not(.matched)");
          if (unmatchedCards.length < 2) return;

          // 高亮一组相同id的卡片（持续1.5秒）
          const targetId = unmatchedCards[0].dataset.id;
          const hintCards = document.querySelectorAll(`.game-card[data-id="${targetId}"].not(.matched)`);

          hintCards.forEach(card => {
            card.style.backgroundColor = "#95d5b2";
            card.style.color = "#1b4332";
          });

          // 1.5秒后移除高亮样式
          setTimeout(() => {
            hintCards.forEach(card => {
              if (!card.classList.contains("matched")) {
                card.style.backgroundColor = "";
                card.style.color = "";
              }
            });
          }, 1500);

          // 提示后扣5分（防止滥用）
          score = Math.max(0, score - 5);
          scoreDisplay.textContent = score;
        }

        // 重置游戏
        function resetGame(isFullReset = true) {
          // 清除计时器
          clearInterval(timer);
          // 重置全局变量
          gameStarted = false;
          if (isFullReset) {
            timeLeft = 60;
            score = 0;
            pairsLeft = 6;
            timeDisplay.textContent = timeLeft;
            scoreDisplay.textContent = score;
            pairsLeftDisplay.textContent = pairsLeft;
          }
          flippedCards = [];
          canFlip = true;
          // 重置按钮状态
          startBtn.disabled = false;
          hintBtn.disabled = true;
          // 重新初始化游戏（生成新卡片）
          initGame();
        }

        // 绑定按钮事件
        startBtn.addEventListener("click", startGame);
        hintBtn.addEventListener("click", giveHint);
        resetBtn.addEventListener("click", () => resetGame(true));
        closePopupBtn.addEventListener("click", () => {
          knowledgePopup.style.display = "none";
        });

        // 页面加载完成后初始化游戏
        window.addEventListener("DOMContentLoaded", initGame);
    </script>
</body>
</html>